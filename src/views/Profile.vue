<template>
  <BaseProfile>
    <template v-slot:profile-img>
      <img
        class="user-icon"
        alt="user-icon"
        src="../assets/user-icon-placeholder.svg"
      />
    </template>

    <template v-slot:msg-bubble>
      <div v-if="user.profileMessage" class="msg-bubble">
        {{ user.profileMessage }}
      </div>
      <div v-else class="msg-bubble">Message Bubble Here</div>
    </template>

    <template v-slot:user-title>
      <span class="wishlist-header__owner"
        >{{ user.firstName }}'s Wishlist</span
      >
      <span class="wishlist-header__count">1 / 4 Bought</span>
    </template>

    <template v-slot:user-wishlist>
      <div class="user-wishlist">
        <WishlistItemSmall
          v-for="wishlistItem in wishlistItems"
          :key="wishlistItem.id"
          :productId="wishlistItem.id"
          :name="wishlistItem.displayName || wishlistItem.name"
          :purchased="wishlistItem.purchased"
          :userId="userId"
        />
      </div>
    </template>
  </BaseProfile>
</template>

<script>
import BaseProfile from '@/components/BaseProfile.vue'
import WishlistItemSmall from '@/components/WishlistItemSmall.vue'
import EventService from '@/services/EventService.js'

export default {
  name: 'Profile',
  components: {
    BaseProfile,
    WishlistItemSmall
  },
  props: ['userId', 'firstName', 'shortName', 'lastName', 'profileMessage'],
  data() {
    return {
      event: null,
      wishlistItems: [],
      user: {}
    }
  },
  created() {
    // fetch user data for single id
    EventService.getUser(this.userId)
      .then(res => {
        // this.user.firstName = res.data.firstName
        // this.user.lastName = res.data.lastName
        // this.user.shortName = res.data.shortName
        // this.user.profileMessage = res.data.profileMessage
        this.user = res.data
      })
      .catch(error => {
        console.log(error)
      })

    // fetch user product data for single id
    EventService.getUserProducts(this.userId)
      .then(res => {
        this.wishlistItems = [...res.data]
        console.log('products:', [...res.data])
      })
      .catch(error => {
        console.log(error)
      })

    // console.log('userId is... ', this.userId)
    // console.log('name is... ', this.user.firstName)
    // console.log('short name is... ', this.shortName)
    // console.log('last name is... ', this.lastName)
    // console.log('profile message is... ', this.profileMessage)
    // console.log('event is... ', this.event)
  }
}
</script>

<style scoped lang="scss">
.msg-bubble {
  background: $yellow;
  padding: 0.5rem;
  margin-bottom: 1rem;
  border: 1px solid #39495c;
  border-radius: 0.75rem;
  font-size: 14px;
}

.wishlist-header__owner {
  font-size: 28px;
}

.wishlist-header__count {
  float: right;
  font-size: 14px;
}
</style>
